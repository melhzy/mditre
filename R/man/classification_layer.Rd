% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/layer5_classification.R
\name{classification_layer}
\alias{classification_layer}
\title{Dense Classification Layer}
\usage{
classification_layer(in_feat, out_feat, layer_name = "dense_layer", ...)
}
\arguments{
\item{in_feat}{Number of input features (rules)}

\item{out_feat}{Number of output classes}

\item{layer_name}{Name for this layer instance (default: "dense_layer")}

\item{...}{Additional arguments passed to base layer}
}
\value{
An R6 class representing a Dense classification layer
}
\description{
Linear classifier for computing predicted outcome. Combines rule responses
and slope information using learned weights, with binary concrete selection
of active rules.
}
\details{
Architecture:
\itemize{
\item Input: (x, x_slope) both (batch, num_rules)
\item Output: (batch,) - log odds for binary classification
}

The layer implements:
\deqn{logit(y) = W \cdot (x \odot x_{slope} \odot \beta) + b}

where:
\itemize{
\item \eqn{W} are learned classification weights
\item \eqn{x} are rule responses (abundance)
\item \eqn{x_{slope}} are slope rule responses
\item \eqn{\beta} are binary selection variables (via binary concrete)
\item \eqn{b} is the bias term
}

\strong{Binary Concrete} is used to select which rules are active, enabling
sparse, interpretable models.
}
\examples{
\dontrun{
library(torch)

# Create classification layer
layer <- classification_layer(
  in_feat = 5,   # 5 rules
  out_feat = 1   # binary classification
)

# Forward pass
x <- torch_rand(32, 5)         # rule responses
x_slope <- torch_randn(32, 5)  # slope responses
output <- layer(x, x_slope)
print(output$shape)  # [32] - log odds

# Convert to probabilities
probs <- torch_sigmoid(output)
}

}
