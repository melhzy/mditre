% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/models.R
\name{mditre_abun_model}
\alias{mditre_abun_model}
\title{MDITRE Model (Abundance Only - no slopes)}
\usage{
mditre_abun_model(
  num_rules,
  num_otus,
  num_otu_centers,
  num_time,
  num_time_centers,
  dist,
  emb_dim
)
}
\arguments{
\item{num_rules}{Number of rules to learn}

\item{num_otus}{Number of OTUs in the dataset}

\item{num_otu_centers}{Number of phylogenetic centers (for dynamic aggregation)}

\item{num_time}{Number of time points}

\item{num_time_centers}{Number of time window centers (kept for compatibility)}

\item{dist}{Phylogenetic distance matrix or OTU embeddings}

\item{emb_dim}{Embedding dimension for dynamic spatial aggregation}
}
\value{
An R6 class representing the MDITRE Abundance-only model
}
\description{
Simplified MDITRE model that only uses abundance information (no slope computation).
Useful when rate-of-change is not informative or data is too sparse.
}
\details{
\strong{Architecture}:
\itemize{
\item \strong{Layer 1}: SpatialAggDynamic - Phylogenetic focus using learned embeddings
\item \strong{Layer 2}: TimeAggAbun - Temporal focus (abundance only, no slopes)
\item \strong{Layer 3}: Threshold detector - Gated response for abundance only
\item \strong{Layer 4}: Rules (1 instance) - Soft AND for abundance rules
\item \strong{Layer 5}: DenseLayerAbun - Classification with rule selection (no slopes)
}

\strong{Input}: (batch, num_otus, num_time) - OTU abundance time-series
\strong{Output}: (batch,) - Log odds for binary classification

This variant is faster and has fewer parameters than the full MDITRE model.
}
\examples{
\dontrun{
library(torch)
library(ape)

# Setup
num_otus <- 50
num_time <- 10
tree <- rtree(num_otus)
phylo_dist <- cophenetic.phylo(tree)

# Create abundance-only model
model <- mditre_abun_model(
  num_rules = 5,
  num_otus = num_otus,
  num_otu_centers = 10,
  num_time = num_time,
  num_time_centers = 1,
  dist = phylo_dist,
  emb_dim = 3
)

# Forward pass
x <- torch_randn(32, num_otus, num_time)
predictions <- model(x)
}

}
