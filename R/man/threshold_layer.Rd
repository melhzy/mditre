% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/layer3_detector.R
\name{threshold_layer}
\alias{threshold_layer}
\title{Threshold Detector Layer}
\usage{
threshold_layer(
  num_rules,
  num_otus,
  num_time_centers,
  layer_name = "threshold",
  ...
)
}
\arguments{
\item{num_rules}{Number of rule detectors}

\item{num_otus}{Number of OTUs}

\item{num_time_centers}{Number of time centers (unused, kept for compatibility)}

\item{layer_name}{Name for this layer instance (default: "threshold")}

\item{...}{Additional arguments passed to base layer}
}
\value{
An R6 class representing a Threshold detector layer
}
\description{
Learn threshold abundance for each detector. The output is a sharp but smooth
gated response indicating whether the aggregated abundance from previous steps
is above/below the learned threshold.
}
\details{
Architecture:
\itemize{
\item Input: (batch, num_rules, num_otus)
\item Output: (batch, num_rules, num_otus)
}

The layer uses sigmoid activation to create a smooth but sharp gating function:
\deqn{output = \sigma((x - threshold) \times k)}

where k is a temperature parameter controlling the sharpness of the gate.
}
\examples{
\dontrun{
library(torch)

# Create threshold layer
layer <- threshold_layer(
  num_rules = 5,
  num_otus = 20,
  num_time_centers = 1
)

# Forward pass
x <- torch_randn(32, 5, 20)  # batch=32, rules=5, otus=20
output <- layer(x)
print(output$shape)  # [32, 5, 20]

# With higher temperature (sharper threshold)
output_sharp <- layer(x, k = 5.0)
}

}
